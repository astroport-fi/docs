import Admonition from '@theme/Admonition'


# Smart Contracts

## List of Contracts

- [**`factory:`**](./factory) Creates new Astroport pair contracts (and associated LP token contracts) which are tracked in a registry and used as a directory for all pairs. 
- [**`constant_product_pools:`**](./swap-pairs/constant-product-pools) Uses the widely known xy=k formula.
- [**`stableswap_pools:`**](./swap-pairs/stableswap-pools) Uses the 4A(Rx+Ry) + D formula, resulting in a constant price ∆x / ∆y = 1.
- [**`oracle:`**](./oracle) Calculates a 1 day TWAP for an xy=k Astroport pool.
- [**`router:`**](./router) Contains logic to facilitate multi-hop swaps for Cosmos native & CW20 tokens.
- [**`token:`**](./token) Implementation for the ASTRO token.
- [**`generator:`**](./tokenomics/generator) Allocates token rewards (ASTRO) for various LP tokens and distributes them pro-rata to LPs. 
- [**`generator_proxy:`**](./tokenomics/generator-proxy) Allows an external staking contract to be connected to the Generator to offer a second reward besides ASTRO token emissions.
- [**`maker:`**](./tokenomics/maker) Collects part of Astroport's pair fees (according to the factory's `maker_fee`).
- [**`staking:`**](./tokenomics/staking)  Allows ASTRO holders to stake their tokens in exchange for xASTRO.
- [**`vesting:`**](./tokenomics/vesting) Progressively unlocks ASTRO that can then be distributed to LPs via the Generator contract.
- [**`xastro_token:`**](./tokenomics/xastro-token) ASTRO token implementation.
- [**`astral_assembly:`**](./astral-assembly) Allows xASTRO holders as well as Initial Astroport Builders to post and vote on new on-chain proposals that can execute arbitrary logic.


## Contract Addresses 

<Admonition type="info" title="NOTE">
For a complete list of addresses, visit the official [Github changelog](https://github.com/astroport-fi/astroport-changelog).
</Admonition>

### Terra 2.0

The following are the addresses for the Astroport `phoenix-1` mainnet deployment.

```json 
{
    "astroport_temporary_multisig": "terra174gu7kg8ekk5gsxdma5jlfcedm653tyg6ayppw", 
    "astal_assembly": "terra1k9j8rcyk87v5jvfla2m9wp200azegjz0eshl7n2pwv852a7ssceqsnn7pq", 
    "assembly_treasury": "terra12ncurr62xe93xrsh2drp4zvehj0gn32lfnshr8k0p4xfyju2knwq2qgmh2", 
    "astro_token": "terra1nsuqsk6kh58ulczatwev87ttq2z6r3pusulg9r24mfj2fvtzd4uq3exn26", 
    "factory": "terra14x9fr055x5hvr48hzy2t4q7kvjvfttsvxusa4xsdcy702mnzsvuqprer8r", 
    "router": "terra1j8hayvehh3yy02c2vtw5fdhz9f4drhtee8p5n5rguvg3nyd6m83qd2y90a", 
    "xastro_staking": "terra1nyu6sk9rvtvsltm7tjjrp6rlavnm3e4sq03kltde6kesam260f8szar8ze", 
    "xastro_token": "terra1x62mjnme4y0rdnag3r8rfgjuutsqlkkyuh4ndgex0wl3wue25uksau39q8", 
    "maker": "terra1ygcvxp9s054q8u2q4hvl52ke393zvgj0sllahlycm4mj8dm96zjsa45rzk", 
    "generator": "terra1ksvlfex49desf4c452j6dewdjs6c48nafemetuwjyj6yexd7x3wqvwa7j9", 
    "generator_vesting": "terra1qyuarnzcc6uuft9n9mltraprreke4v8gvxd8u3nslngxhflhru9qw34nc3", 
    "astroport_whitelist": "terra17aq66zyakz8su32u8tkgwmqemf0sylvv9a23nz7c7ydvkerll28ssss0ug"
}
```

The following are the addresses for the Astroport `pisco-1` testnet deployment.

```json 
{
    "astroport_temporary_multisig": "terra190fxpjfkp6cygr2k9unzjurq42dyehqd579h5j",
    "astal_assembly": "terra195m6n5xq4rkjy47fn5y3s08tfmj3ryknj55jqvgq2y55zul9myzsgy06hk",
    "assembly_treasury": "terra162zc8ssdd5q5lzudq9lxl2lvz74dsdn8hvw0zdk5nnj4k4dwsyas6j6asa",
    "astro_token": "terra167dsqkh2alurx997wmycw9ydkyu54gyswe3ygmrs4lwume3vmwks8ruqnv",
    "factory": "terra1z3y69xas85r7egusa0c7m5sam0yk97gsztqmh8f2cc6rr4s4anysudp7k0",
    "router": "terra1na348k6rvwxje9jj6ftpsapfeyaejxjeq6tuzdmzysps20l6z23smnlv64",
    "xastro_staking": "terra19t8ffmz6q2rdm3rllyksd6sex6n650a4anttzzvz9mf8mqr4nkrq44cyu6",
    "xastro_token": "terra1ctzthkc0nzseppqtqlwq9mjwy9gq8ht2534rtcj3yplerm06snmqfc5ucr",
    "maker": "terra146ffs60x8seza3cq9a447mhw0zqeylkj37ye4uj7rl2uwhvgq89sts2ess",
    "generator": "terra1gc4d4v82vjgkz0ag28lrmlxx3tf6sq69tmaujjpe7jwmnqakkx0qm28j2l",
    "generator_vesting": "terra1703s0etk3u07ur6qjjrxpmjsccfmsfnfwf0h0dket6srz066cemqjxlt78",
    "astroport_whitelist": "terra162zc8ssdd5q5lzudq9lxl2lvz74dsdn8hvw0zdk5nnj4k4dwsyas6j6asa",
    "astro_luna_pool": "terra1udsua9w6jljwxwgwsegvt6v657rg3ayfvemupnes7lrggd28s0wq7g8azm"
}
```

### Terra Classic

The following are the addresses for the Astroport `columbus-5` mainnet deployment.

```json 
{
    "astroport_temporary_multisig": "terra1c7m6j8ya58a2fkkptn8fgudx8sqjqvc8azq0ex", 
    "astal_assembly": "terra1sq9ppsvt4k378wwhvm2vyfg7kqrhtve8p0n3a6", 
    "assembly_treasury": "terra16m3runusa9csfev7ymj62e8lnswu8um29k5zky", 
    "astro_token": "terra1xj49zyqrwpv5k928jwfpfy2ha668nwdgkwlrg3", 
    "factory": "terra1fnywlw4edny3vw44x04xd67uzkdqluymgreu7g", 
    "router": "terra16t7dpwwgx9n3lq6l6te3753lsjqwhxwpday9zx", 
    "xastro_staking": "terra1f68wt2ch3cx2g62dxtc8v68mkdh5wchdgdjwz7", 
    "xastro_token": "terra14lpnyzc9z4g3ugr4lhm8s4nle0tq8vcltkhzh7", 
    "maker": "terra12u7hcmpltazmmnq0fvyl225usn3fy6qqlp05w0", 
    "generator": "terra1zgrx9jjqrfye8swykfgmd6hpde60j0nszzupp9", 
    "generator_vesting": "terra1hncazf652xa0gpcwupxfj6k4kl4k4qg64yzjyf"
}
```

The following are the addresses for the Astroport `bombay-12` testnet deployment.

```json 
{
    "astroport_temporary_multisig": "terra1c7m6j8ya58a2fkkptn8fgudx8sqjqvc8azq0ex", 
    "astal_assembly": "terra109039nj38vnzyryqvcjctdh33r4qlq5dmrzqn0", 
    "assembly_treasury": "terra1dp83pv9kfw27wflsdpj8ewjuzasssaw9lvnqnt", 
    "astro_token": "terra1jqcw39c42mf7ngq4drgggakk3ymljgd3r5c3r5", 
    "factory": "terra15jsahkaf9p0qu8ye873p0u5z6g07wdad0tdq43", 
    "router": "terra13wf295fj9u209nknz2cgqmmna7ry3d3j5kv7t4", 
    "xastro_staking": "terra1h2smqfg9lmemewwde9a4vf8fcp6z8666kxdhzh", 
    "xastro_token": "terra1yufp7cv85qrxrx56ulpfgstt2gxz905fgmysq0", 
    "maker": "terra14906rw2kyu50cdw25x0uymkrlqtgqxjemdfd0n", 
    "generator": "terra1gjm7d9nmewn27qzrvqyhda8zsfl40aya7tvaw5", 
    "generator_vesting": "terra1g73et67yraz33vtwtg8c7q39gq50z2q92dz822", 
}
```

## Access Controls and Permissions

This section gives an overview of smart contract access controls for the full Astroport protocol. Many of the contracts on Astroport are both upgradeable (can have their code ID changed) and have an owner that can change certain parameters.

### Upgradeable Contracts

The following is a list of Astroport smart contracts that can have their code upgraded:

- XYK/Constant product pools
- Stableswap pools
- Maker contract that swaps fees for ASTRO
- Lockdrop contract
- Router contract
- Factory contract
- Vesting contract (contract that decreases amount of ASTRO to give to LPs each year via generator)
- Staking contract for ASTRO → xASTRO
- Generator contract
- Treasury contract
- Assembly contract

The ASTRO token and the xASTRO token **cannot** be upgraded.

### Pool Upgradeability

A specific pair (e.g ASTRO/axlUSDC) cannot have both a stableswap and a xyk pool at the same time. If someone creates a xyk for a specific token pair, Astroport governance will have to deregister the pool if the intent was to use stableswap instead. Same thing if someone creates an invalid stableswap and liquidity should go to a xyk instead. **In short, a xyk pool should not be upgraded to a stableswap or vice-versa.**

### Ownable Contracts

The following is a list of contracts that have an `owner` who can change specific parameters.

#### `Factory`

- Can change general parameters such as the `owner`, `token_code_id`, `fee_address`, `generator_address` and `whitelist_code_id`
- Can update a pair type's configuration which includes its `code_id`, `pair_type` (stableswap, XYK or custom), `total_fee_bps`, `maker_fee_bps` and whether the pool `is_disabled`
- Can deregister a pool
- Can create a brand new pool type

#### `Stableswap Pool`

- Can update the pool amplification (with `next_amp`) and specify the timestamp until which the current amplification scales to the new one (`next_amp_time`)
- The owner can change their own address
- For Terra Classic, the bLUNA specific stableswap can also have its `bluna_rewarder` changed (the contract distributing bLUNA rewards)

#### `Generator`

- Can set the `alloc_points` for a generator as well as mention whether a generator has dual rewards (and attach a proxy contract for 3rd party rewards)
- Can add a new generator, specifying its initial `alloc_points` , whether it gets dual rewards or not and the proxy contract used for 3rd party rewards
- Can update the address of the generator vesting contract
- The `owner` can change their own address

#### `Maker`

- Can update the factory address, xASTRO staking address, vxASTRO fee distributor address, the percentage of fees going to vxASTRO stakers and the `max_spread` used to swap fee tokens to ASTRO
- Can update bridge tokens used to swap fee tokens to ASTRO
- The `owner` can change their own address

#### `Vesting`

- Can add new vesting schedules targeted at different addresses
- The `owner` can change their own address

#### `Treasury`

- Current treasury admins can change the list of admins

#### `Assembly`

- Can change the proposal voting period, the delay between marking a proposal as successful and it being available for execution and the proposal expiration period
- Can change the amount of xASTRO needed to lock in order to create a proposal, the required voting power quorum needed to pass a vote, the required majority of votes that a proposal needs to have to be successful and the list of whitelisted domains used to sanitize the main link submitted in a proposal

### Governance Delays

The Astral Assembly enforces a delay between the moment when a proposal is marked as successful and the moment when that proposal can be executed. You can check out the Assembly parameters here.

### Pausing the Protocol

Although governance can propose and implement a pause functionality in the protocol, at the moment there are no pause functions per se in any contract. This design decision stems from the fact that Astroport was initially envisioned as an unstoppable protocol which is as close as possible to a public good for the whole Cosmos ecosystem.

There are though ways to deregister pools from the Astroport Factory as well as completely stop ASTRO emissions from the Generator contract.

